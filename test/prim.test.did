/*
Encoding tests for primitive types
*/

// fundamentally wrong
assert blob ""           !: () "empty";
assert blob "\00\00"     !: () "no magic bytes";
assert blob "DADL"       !: () "wrong magic bytes";
assert blob "DADL\00\00" !: () "wrong magic bytes";

// nullary input
assert blob "DIDL\00\00"     : ();
assert blob "DIDL\00\00\00" !: () "nullary: too long";
assert blob "DIDL\00\01\7f"  : () "Additional parameters are ignored";

// primitive types
assert blob "DIDL\00\01\7f"     : (null);
assert blob "DIDL\00\01\7f\00" !: (null) "null: too long";
assert blob "DIDL\00\00"       !: (null) "null: missing";

assert blob "DIDL\00\01\7e\00" == "(false)" : (bool) "bool: false";
assert blob "DIDL\00\01\7e\01" == "(true)"  : (bool) "bool: true";
assert blob "DIDL\00\01\7e"                !: (bool) "bool: missing";
assert blob "DIDL\00\01\7e\02"             !: (bool) "bool: out of range";
assert blob "DIDL\00\01\7e\ff"             !: (bool) "bool: out of range";

assert blob "DIDL\00\01\7d\00"                  : (nat) "nat: 0";
assert blob "DIDL\00\01\7d\7f"                  : (nat) "nat: 0x7f";
assert blob "DIDL\00\01\7d\80\01"  == "(128)"   : (nat) "nat: leb (two bytes)";
assert blob "DIDL\00\01\7d\ff\7f"  == "(16383)" : (nat) "nat: leb (two bytes, all bits)";
assert blob "DIDL\00\01\7d\80"                 !: (nat) "nat: leb too short";
assert blob "DIDL\00\01\7d\80\00"              !: (nat) "nat: leb overlong";

